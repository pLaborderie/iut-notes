(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{170:function(e,t,a){e.exports=a(295)},293:function(e,t,a){},295:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(8),l=a.n(o),c=a(67),i=a(297),s=a(46),u=a(48),m=a(37);var p=function(){return r.a.createElement("div",null,r.a.createElement("h1",null,"Bienvenue sur IUT Notes !"),r.a.createElement("p",null,"Page en cours de construction..."))},d=a(38),f=a.n(d),g=a(64),v=a(298),E=a(301),h=a(12),b=a(100),w=a(31),y=a(34),x=a.n(y);function j(){var e=Object(w.a)(["\n  mutation login($email: String!, $password: String!) {\n    logIn(email: $email, password: $password)\n  }\n"]);return j=function(){return e},e}function O(){var e=Object(w.a)(["\n  mutation createUser($name: String!, $email: String!, $password: String!) {\n    addUser(name: $name, email: $email, password: $password) {\n      email\n      password\n    }\n  }\n"]);return O=function(){return e},e}var k=x()(O()),C=x()(j()),S=r.a.createContext({token:"fetching...",setToken:function(){}}),I=v.a.Item,z={labelCol:{xs:{span:24},sm:{span:5}},wrapperCol:{xs:{span:24},sm:{span:12}}};var T=v.a.create({name:"login"})(Object(m.c)(function(e){var t=e.form,a=e.client,o=Object(n.useContext)(S),l=o.token,c=o.setToken,i=t.getFieldDecorator;function s(){return(s=Object(g.a)(f.a.mark(function e(t){var n,r;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,a.mutate({mutation:C,variables:t});case 3:n=e.sent,r=n.data,localStorage.setItem("iut-notes-jwt",r.logIn),c(r.logIn),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.error(e.t0);case 12:case"end":return e.stop()}},e,null,[[0,9]])}))).apply(this,arguments)}return l?r.a.createElement(u.a,{to:"/"}):r.a.createElement(v.a,Object.assign({},z,{onSubmit:function(e){e.preventDefault(),t.validateFields(function(e,t){e?console.error(e):function(e){s.apply(this,arguments)}(t)})}}),r.a.createElement("h1",null,"Se connecter"),r.a.createElement(I,{label:"Email"},i("email",{rules:[{required:!0,message:"Veuillez saisir une adresse email."},{type:"email",message:"Veuillez saisir une adresse email valide."}],validateTrigger:"onBlur"})(r.a.createElement(E.a,{name:"email",placeholder:"Adresse email",prefix:r.a.createElement(h.a,{type:"mail"})}))),r.a.createElement(I,{label:"Mot de passe"},i("password",{rules:[{required:!0,message:"Veuillez saisir un mot de passe."},{min:8,message:"Le mot de passe doit faire au moins 8 caract\xe8res."}],validateTrigger:"onBlur"})(r.a.createElement(E.a,{type:"password",name:"password",placeholder:"Mot de passe",prefix:r.a.createElement(h.a,{type:"lock"})}))),r.a.createElement(I,{wrapperCol:{span:12,offset:6}},r.a.createElement(b.a,{type:"primary",htmlType:"submit"},"Confirmer")))})),$=a(302),F=a(299);function q(){var e=Object(w.a)(["\n  query getAllNotes {\n    notes {\n      title\n      category {\n        name\n        semester\n      }\n      author {\n        name\n      }\n      createdAt\n      updatedAt\n    }\n  }\n"]);return q=function(){return e},e}var N=x()(q());var V=function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("h1",null,"Liste des notes"),r.a.createElement(m.b,{query:N},function(e){var t=e.loading,a=e.error,n=e.data;return t?r.a.createElement($.a,null):a?"Error! "+a.message:r.a.createElement(F.a,{header:"Notes correspondantes",itemLayout:"horizontal",dataSource:n.notes,bordered:!0,locale:{emptyText:"Aucune note trouv\xe9e."},renderItem:function(e){return r.a.createElement(F.a.Item,null,r.a.createElement(F.a.Item.Meta,{title:e.title,description:r.a.createElement("p",null,"Auteur : ",e.author.name," ",r.a.createElement("br",null),"Date de cr\xe9ation : ",new Date(parseInt(e.createdAt)).toLocaleDateString(),r.a.createElement("br",null),"Cat\xe9gorie : ",e.category.semester," - ",e.category.name)}))}})}))},A=a(162),B=a(303),D=a(80);function L(){var e=Object(w.a)(["\n  query getCategories {\n    categories {\n      name\n      semester\n      id\n    }\n  }\n"]);return L=function(){return e},e}var M=x()(L());function P(){var e=Object(w.a)(["\n  mutation createNote($title: String!, $content: String!, $category: ID!) {\n    addNote(title: $title, content: $content, category: $category) {\n      id\n    }\n  }\n"]);return P=function(){return e},e}var U=x()(P()),W=a(166);var _=function(e){var t=e.name,a=e.label,n=e.form,o=e.rules,l=e.textarea,c=Object(W.a)(e,["name","label","form","rules","textarea"]),i=l?r.a.createElement(E.a.TextArea,Object.assign({name:t},c,{autosize:{minRows:4}})):r.a.createElement(E.a,Object.assign({name:t},c));return r.a.createElement(v.a.Item,{label:a},n.getFieldDecorator(t,{rules:o,validateTrigger:"onBlur"})(i))},H={labelCol:{xs:{span:24},sm:{span:5}},wrapperCol:{xs:{span:24},sm:{span:12}}},J=["Tous","S1","S2","S3","IPI","PEL","LP"];var R=v.a.create({name:"create_note"})(Object(m.c)(function(e){var t=e.client,a=e.form,o=Object(n.useContext)(S).token,l=Object(n.useState)(null),i=Object(c.a)(l,2),s=i[0],m=i[1],p=Object(n.useState)(""),d=Object(c.a)(p,2),E=d[0],h=d[1],w=Object(n.useState)("Tous"),y=Object(c.a)(w,2),x=y[0],j=y[1];function O(){return(O=Object(g.a)(f.a.mark(function e(){var a,n;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.mutate({mutation:M});case 3:a=e.sent,n=a.data,m(n.categories),h(n.categories[0].id),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.error(e.t0);case 12:case"end":return e.stop()}},e,null,[[0,9]])}))).apply(this,arguments)}function k(e){return C.apply(this,arguments)}function C(){return(C=Object(g.a)(f.a.mark(function e(n){return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.mutate({mutation:U,variables:n});case 3:a.resetFields(),B.a.success("Note cr\xe9\xe9e !"),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),B.a.error(e.t0.message),console.error(e.t0);case 11:case"end":return e.stop()}},e,null,[[0,7]])}))).apply(this,arguments)}function I(e){return"Tous"===x||x===e.semester}return Object(n.useEffect)(function(){!function(){O.apply(this,arguments)}()},[]),Object(n.useEffect)(function(){if(s){var e=s.filter(I);e.length?e.findIndex(function(e){return e.id===E})<0&&h(e[0].id):h("")}},[x]),o?r.a.createElement(r.a.Fragment,null,r.a.createElement("h1",null,"Cr\xe9er une note"),r.a.createElement(v.a,Object.assign({},H,{onSubmit:function(e){e.preventDefault(),a.validateFields(function(){var e=Object(g.a)(f.a.mark(function e(t,a){return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=4;break}console.error(t),e.next=6;break;case 4:return e.next=6,k(Object(A.a)({},a,{category:E}));case 6:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}())}}),r.a.createElement(_,{label:"Titre",form:a,rules:[{required:!0,message:"Veuillez saisir un titre."}],name:"title",placeholder:"Titre"}),r.a.createElement(v.a.Item,{label:"Semestre"},r.a.createElement(D.a,{value:x,onChange:function(e){return j(e)}},J.map(function(e){return r.a.createElement(D.a.Option,{key:e,value:e},e)}))),r.a.createElement(v.a.Item,{label:"Cat\xe9gorie"},r.a.createElement(D.a,{showSearch:!0,value:E,onChange:function(e){return h(e)},filterOption:function(e,t){return t.props.children.toLowerCase().includes(e.toLowerCase())},notFoundContent:"Aucune cat\xe9gorie trouv\xe9e."},s&&s.filter(I).map(function(e){return r.a.createElement(D.a.Option,{key:e.id,value:e.id,onChange:function(){return h(e.id)}},e.name)}))),r.a.createElement(_,{label:"Note",form:a,rules:[{required:!0,message:"Veuillez saisir un contenu."}],name:"content",placeholder:"Contenu",textarea:!0}),r.a.createElement(v.a.Item,{wrapperCol:{span:12,offset:6}},r.a.createElement(b.a,{type:"primary",htmlType:"submit"},"Confirmer")))):r.a.createElement(u.a,{to:"/login"})})),G=v.a.Item,K={labelCol:{xs:{span:24},sm:{span:5}},wrapperCol:{xs:{span:24},sm:{span:12}}};var Q=v.a.create({name:"signup"})(Object(m.c)(function(e){var t=e.form,a=e.client,o=t.getFieldDecorator,l=Object(n.useContext)(S),c=l.token,i=l.setToken;return c?r.a.createElement(u.a,{to:"/"}):r.a.createElement(v.a,Object.assign({},K,{onSubmit:function(e){e.preventDefault(),t.validateFields(function(e,t){var n,r=t.name,o=t.email,l=t.password;e?console.log(e):(n={name:r,email:o,password:l},a.mutate({mutation:k,variables:n}).then(function(e){var t=n.email,r=n.password;a.mutate({mutation:C,variables:{email:t,password:r}}).then(function(e){localStorage.setItem("iut-notes-jwt",e.data.logIn),i(e.data.logIn)}).catch(function(e){return console.error(e)})}).catch(function(e){return console.error(e)}))})}}),r.a.createElement("h1",null,"Cr\xe9er un compte"),r.a.createElement(G,{label:"Nom"},o("name",{rules:[{required:!0,message:"Veuillez saisir un nom."}],validateTrigger:"onBlur"})(r.a.createElement(E.a,{name:"name",placeholder:"Nom",prefix:r.a.createElement(h.a,{type:"user"})}))),r.a.createElement(G,{label:"Email"},o("email",{rules:[{required:!0,message:"Veuillez saisir une adresse email."},{pattern:/[a-z0-9!#$%&'*+\/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+\/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?/,message:"Veuillez saisir une adresse email valide."}],validateTrigger:"onBlur"})(r.a.createElement(E.a,{name:"email",placeholder:"Adresse email",prefix:r.a.createElement(h.a,{type:"mail"})}))),r.a.createElement(G,{label:"Mot de passe"},o("password",{rules:[{required:!0,message:"Veuillez saisir un mot de passe."},{min:8,message:"Le mot de passe doit faire au moins 8 caract\xe8res."}],validateTrigger:"onBlur"})(r.a.createElement(E.a,{type:"password",name:"password",placeholder:"Mot de passe",prefix:r.a.createElement(h.a,{type:"lock"})}))),r.a.createElement(G,{label:"R\xe9p\xe9tez le mot de passe"},o("repeatPassword",{rules:[{required:!0,message:"Veuillez confirmer le mot de passe."},{validator:function(e,a,n){n(t.getFieldValue("password")===a?[]:["Password don't match"])},message:"Les mots de passes doivent \xeatre identiques."}],validateTrigger:"onBlur"})(r.a.createElement(E.a,{type:"password",name:"repeatPassword",placeholder:"Mot de passe",prefix:r.a.createElement(h.a,{type:"lock"})}))),r.a.createElement(G,{wrapperCol:{span:12,offset:6}},r.a.createElement(b.a,{type:"primary",htmlType:"submit",disabled:!Object.entries(t.getFieldsError()).every(function(e){return void 0===e[1]})},"Confirmer")))}));var X=[{name:"Accueil",path:"/",exact:!0,component:p,icon:"home"},{name:"Notes",path:"/notes",exact:!0,component:V,icon:"file-search"}],Y=[{name:"Nouvelle note",path:"/notes/new",component:R,icon:"form"},{name:"Mon compte",path:"/account",component:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("h1",null,"Mon compte"))},icon:"user"},{name:"Se d\xe9connecter",path:"/logout",component:function(){var e=Object(n.useContext)(S),t=e.token,a=e.setToken;return t?r.a.createElement(r.a.Fragment,null,r.a.createElement("h1",null,"Voulez-vous vraiment vous d\xe9connecter ?"),r.a.createElement(b.a,{type:"danger",onClick:function(){t&&a("")}},"Se d\xe9connecter")):r.a.createElement(u.a,{to:"/"})},icon:"logout"}],Z=[{name:"Cr\xe9er un compte",path:"/signup",component:Q,icon:"user"},{name:"Se connecter",path:"/login",component:T,icon:"login"}],ee=X.concat(Y,Z),te=a(300),ae=a(128);function ne(){var e=Object(w.a)(["\n  height: 32px;\n  color: #FFF;\n  margin: 16px;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n"]);return ne=function(){return e},e}function re(){var e=Object(w.a)(["\n  @media (max-width: 992px) {\n    position: absolute !important;\n    min-height: 100vh !important;\n    z-index: 3;\n  }\n"]);return re=function(){return e},e}var oe=Object(ae.a)(i.a.Sider)(re()),le=ae.a.h3(ne());var ce=Object(u.g)(function(e){var t=e.location,a=e.routes;return r.a.createElement(oe,{breakpoint:"lg",collapsedWidth:"0"},r.a.createElement(le,null,"IUT Notes"),r.a.createElement(te.b,{theme:"dark",mode:"inline",style:{lineHeight:"64px"}},a.map(function(e){return r.a.createElement(te.b.Item,{key:e.path,className:t.pathname===e.path?"ant-menu-item-selected":""},r.a.createElement(s.b,{to:e.path},e.icon&&r.a.createElement(h.a,{type:e.icon}),r.a.createElement("span",null,e.name)))})))}),ie=a(161),se=localStorage.getItem("iut-notes-jwt"),ue=window.location,me=ue.protocol,pe=ue.hostname,de=ue.port,fe="".concat(me,"//").concat(pe,":").concat(de,"/graphql");console.log(fe);var ge=new ie.a({uri:fe,headers:{authorization:se?"Bearer ".concat(se):""}}),ve=i.a.Content;var Ee=function(){var e=Object(n.useState)("fetching..."),t=Object(c.a)(e,2),a=t[0],o=t[1];return Object(n.useEffect)(function(){var e=localStorage.getItem("iut-notes-jwt")||"";o(e)},[]),r.a.createElement(m.a,{client:ge},r.a.createElement(S.Provider,{value:{token:a,setToken:o}},r.a.createElement(s.a,null,r.a.createElement(i.a,null,r.a.createElement(ce,{routes:X.concat(a?Y:Z)}),r.a.createElement(ve,{style:{padding:"10px 50px",flexGrow:1,minHeight:"100vh"}},r.a.createElement(u.d,null,ee.map(function(e){return r.a.createElement(u.b,Object.assign({key:"route-".concat(e.path)},e))})))))))};a(293),a(294),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(r.a.createElement(Ee,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[170,1,2]]]);
//# sourceMappingURL=main.1f4ab07c.chunk.js.map